/*
 * Copyright (c) 2007-2014 Kaazing Corporation. All rights reserved.
 * 
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

function defineSplitPanel(a){a.SplitPanel=a.Base.create("splitPanel",a.Widget,[],{initializer:function(){var b=this,c=this.get("topPanel");c&&this.set("topPanel",a.one(c));var d=this.get("bottomPanel");d&&this.set("bottomPanel",a.one(d));var e=this.get("divider");e&&this.set("divider",a.one(e)),a.one("window").on("resize",b.resizeFn,b)},renderUI:function(){var b=this,c=b.getSizeAttr(),d=b.getTopPositionAttr(),e=b.getBottomPositionAttr(),f=b.get("contentBox"),g=b.get("boundingBox"),h=b.get("topContainer");h||(h=createDIV(f,"yui3-splitpanel-"+d+"-panel"),b.set("topContainer",h));var i=b.get("topPanel");i&&h.append(i);var j=b.get("divider");j||(j=createDIV(f,"yui3-splitpanel-divider").set("id","splitPanelDivider"),b.set("divider",j));var k=b.get("bottomContainer");k||(k=createDIV(f,"yui3-splitpanel-"+e+"-panel"),b.set("bottomContainer",k));var l=b.get("bottomPanel");l&&k.append(l);var m=parseInt(f.getStyle(c),10),n=b.getFullSize(j),o=b.get("initialPosition"),p=0;isNumeric(o)?(p=parseInt(o,10),0>p&&(p=m+p)):o.endsWith("%")?(p=parseInt(o.substring(0,o.length-1),10),0>p&&(p=100+p),p=Math.floor(p*m)):o.endsWith("px")&&(p=parseInt(o.substring(0,o.length-2),10),0>p&&(p=m+p)),p-=Math.floor((n+1)/2),p=Math.max(p,b.get("topPanelMinSize")+1),p=Math.min(p,m-b.get("bottomPanelMinSize")-n),h.setStyle(c,p-1),j.setStyle(d,p),k.setStyle(d,p+n),k.setStyle(c,m-(p+n)),b.set("desiredBottomSize",m-(p+n));var q=new a.DD.Drag({node:"#splitPanelDivider"}).plug(a.Plugin.DDConstrained,{constrain2node:f});b.set("drag",q),q.on("drag:start",b.onDragStart,b),q.on("drag:drag",b.onDragDrag,b),q.on("drag:align",function(a){var c=a.target,d=b.get("contentBox"),e=b.get("divider"),f=b.get("topPanelMinSize"),g=b.get("bottomPanelMinSize"),h=b.getSizeAttr(),i,j,k,l=d.getXY(),m=parseInt(d.getStyle(h),10),n=b.getFullSize(e);b.isVertical()?(i=l[1]+f,j=l[1]+m-g-n,k=a.pageY-c.deltaXY[1],i>k?k=i:k>j&&(k=j),c.actXY=[d.getX(),k]):(i=l[0]+f,j=l[0]+m-g-n,k=a.pageX-c.deltaXY[0],i>k?k=i:k>j&&(k=j),c.actXY=[k,d.getY()]),a.preventDefault()})},resizeFn:function(a){var b=this,c=b.getSizeAttr(),d=b.getTopPositionAttr(),e=b.get("contentBox"),f=parseInt(e.getStyle(c),10),g=b.get("topContainer"),h=parseInt(g.getStyle(c),10),i=b.getFullSize(g),j=b.get("divider"),k=b.getFullSize(j),l=b.get("bottomContainer"),m=parseInt(l.getStyle(c),10),n=b.getFullSize(l),o=b.get("desiredBottomSize"),p=i+k+n,q=f-p;if(q>0)o>n&&(o>=n+q?(l.setStyle(c,m+q),q=0):(q=n+q-o,l.setStyle(c,m+q))),q>0&&(g.setStyle(c,h+q),j.setStyle(d,parseInt(j.getStyle(d),10)+q),l.setStyle(d,parseInt(l.getStyle(d),10)+q));else if(0>q){q=-q;var r=b.get("topPanelMinSize"),s=b.get("bottomPanelMinSize"),t;i>r&&(t=i-r,t=Math.min(t,q),g.setStyle(c,h-t),j.setStyle(d,parseInt(j.getStyle(d),10)-t),l.setStyle(d,parseInt(l.getStyle(d),10)-t),q-=t),q>0&&l.setStyle(c,m-q)}},onDragStart:function(a){this.set("lastDivPosition",this.getDivPosition(a))},onDragDrag:function(a){var b=this.getDivPosition(a),c=this.get("lastDivPosition"),d=b-c;if(0!==d){var e=this.getSizeAttr(),f=this.getTopPositionAttr(),g=this.get("topContainer");g.setStyle(e,parseInt(g.getStyle(e),10)+d);var h=this.get("divider"),i=parseInt(h.getStyle(f),10);h.setStyle(f,i+d);var j=this.get("bottomContainer"),k=parseInt(j.getStyle(e),10);i=parseInt(j.getStyle(f),10),j.setStyle(f,i+d),j.setStyle(e,k-d),this.set("desiredBottomSize",k-d),this.set("lastDivPosition",b)}},isVertical:function(){return"vertical"===this.get("direction")},getDivPosition:function(a){return this.isVertical()?a.pageY:pageX},getSizeAttr:function(a){return this.isVertical()?"height":"width"},getTopPositionAttr:function(a){return this.isVertical()?"top":"left"},getBottomPositionAttr:function(a){return this.isVertical()?"bottom":"right"},getFullSize:function(a){var b=this.getSizeAttr(),c=this.getTopPositionAttr(),d=this.getBottomPositionAttr(),e=a.getStyle("margin-"+c);e=e?parseInt(e,10):0;var f=a.getStyle("border-"+c);f=f?parseInt(f,10):0;var g=parseInt(a.getStyle(b),10),h=a.getStyle("border-"+d);h=h?parseInt(h,10):0;var i=a.getStyle("margin-"+d);i=i?parseInt(i,10):0;var g=e+f+g+h+i;return g}},{ATTRS:{container:{value:null},direction:{value:"vertical"},topContainer:{value:null},bottomContainer:{value:null},initialPosition:{value:"50%"},desiredBottomSize:{value:null},topPanel:{value:null},topPanelMinSize:{value:0},bottomPanel:{value:null},bottomPanelMinSize:{value:0},divider:{value:null},lastDivPosition:{value:null}}})}YUI.add("about-panel",function(a){"use strict";var b=a.Lang,c="aboutPanel";a.AboutPanel=a.Base.create(c,a.Panel,[a.WidgetInheritCss],{firstTime:!0,initializer:function(){this.plug(a.Plugin.Drag,{handles:[".yui3-widget-hd"]}),this.dd.plug(a.Plugin.DDConstrained,{constraint2node:"#content"}),this.set("dragObj",new a.DD.Drag({node:"#aboutPanel"})),this.on(a.ClusterModel.prototype.UPDATE_AVAILABLE_EVENT,this.updateAvailableNotification,this)},display:function(){this.firstTime?(this.render(),this.firstTime=!1):centerPanel(this)},updateAvailableNotification:function(){if(this.get("app").get("manualCheckingForUpdate")){this.get("app").set("manualCheckingForUpdate",!1);var a=this.get("updateTimeout");null!=a&&(clearTimeout(a),this.set("updateTimeout",null)),this.renderUI()}},renderUI:function(){a.AboutPanel.superclass.renderUI.apply(this,arguments);var b=a.one(this.get("contentBox")),c=b.one("#aboutProduct"),d=b.one("#aboutVersion"),e=b.one("#aboutBuild"),f=this.getButton("updateButton","footer"),g=this.get("app"),h=g.clusterModel,i=computeDisplayVersionInfo(h.get("versionInfo")),j=b.one("#updateAvailable"),k=b.one("#aboutPanelUpdateAvailable"),l=b.one("#aboutCheckingForUpdate"),m=h.get("updateVersion"),n=this.get("updateTimeout");if(null!=n&&(clearTimeout(n),this.set("updateTimeout",null)),m)l.addClass("hidden"),k.removeClass("hidden"),f.addClass("hidden"),j.setHTML(m);else if(k.addClass("hidden"),this.get("app").get("manualCheckingForUpdate")){l.removeClass("hidden"),f.addClass("hidden");var o=this;n=setTimeout(function(){o.get("app").set("manualCheckingForUpdate",!1),o.renderUI()},1e4),this.set("updateTimeout",n)}else l.addClass("hidden"),f.removeClass("hidden");i?(c.setHTML(i[0]),d.setHTML(i[1]),e.setHTML(i[2])):(c.set("text",""),d.set("text",""),e.set("text",""))},handleOkayButton:function(a){}},{ATTRS:{srcNode:{value:"#aboutPanel"},app:{value:null},centered:{value:!0},modal:{value:!0},zIndex:{value:5},buttons:{value:[{value:"OK",classNames:"commandButton aboutPanelButton",action:function(a){a.preventDefault(),this.set("checkingForUpdate",!1),this.get("app").set("manualCheckingForUpdate",!1);var b=this.get("updateTimeout");null!=b&&(clearTimeout(b),this.set("updateTimeout",null)),this.hide()},section:a.WidgetStdMod.FOOTER},{value:"Check for Update",name:"updateButton",classNames:"commandButton aboutPanelButton updateButton",action:function(a){a.preventDefault(),this.get("app").set("manualCheckingForUpdate",!0);var b=this.get("app").clusterModel,c=this;b.getGateways()[0].get("mngtApi").forceUpdateVersionCheck(function(a){setTimeout(function(){var a=b.getGateways()[0].get("mngtApi").getUpdateVersion(function(a){a&&(b.set("updateVersion",a),c.renderUI())})},2e3)}),this.set("checkingForUpdate",!0),this.renderUI()},section:a.WidgetStdMod.FOOTER}]},updateTimeout:{value:null}}})},"0.99",{requires:["panel","dd","dd-plugin","dd-drag","event","gallery-widget-inherit-css"],skinnable:!1}),YUI.add("update-panel",function(a){"use strict";var b=a.Lang,c="updatePanel";a.UpdatePanel=a.Base.create(c,a.Panel,[a.WidgetInheritCss],{firstTime:!0,initializer:function(){this.plug(a.Plugin.Drag,{handles:[".yui3-widget-hd"]}),this.dd.plug(a.Plugin.DDConstrained,{constraint2node:"#content"}),this.set("dragObj",new a.DD.Drag({node:"#updatePanel"}))},display:function(){this.firstTime?(this.render(),this.firstTime=!1):centerPanel(this)},renderUI:function(){a.UpdatePanel.superclass.renderUI.apply(this,arguments);var b=a.one(this.get("contentBox")),c=b.one("#updateVersion"),d=this.get("app"),e=d.clusterModel;c.setHTML(e.get("updateVersion"))},handleOkayButton:function(a){}},{ATTRS:{srcNode:{value:"#updatePanel"},app:{value:null},centered:{value:!0},modal:{value:!0},zIndex:{value:5},buttons:{value:[{value:"OK",classNames:"commandButton updateOkay",action:function(a){a.preventDefault(),this.hide()},section:a.WidgetStdMod.FOOTER}]}}})},"0.99",{requires:["panel","dd","dd-plugin","dd-drag","event","gallery-widget-inherit-css"],skinnable:!1}),YUI.add("login-panel",function(a){"use strict";var b=a.Lang,c="loginPanel";a.LoginPanel=a.Base.create(c,a.Panel,[a.WidgetInheritCss],{firstTime:!0,connectionUrlField:a.one("#connectionUrl"),usernameField:a.one("#loginUsername"),passwordField:a.one("#loginPassword"),loginInvalidMessage:a.one("#loginInvalidMessage"),initializer:function(){var b=this,c=function(b){var c=b.keyCode?b.keyCode:b.which;if(13===c){b.preventDefault();var d=a.one("#loginOkay");d.simulate("click")}};this.connectionUrlField.on("keypress",c),this.usernameField.on("keypress",c),this.passwordField.on("keypress",c);var d=a.one("#loginOkay");d.on("click",function(a){this.handleLoginButton(a)},this)},display:function(a,b,c,d,e,f){var g=this;this.connectionUrlField.set("value",cvtUndefOrNull(a,"")),b||this.connectionUrlField.setAttribute("readonly","readonly"),this.usernameField.set("value",cvtUndefOrNull(d,"")),this.passwordField.set("value",cvtUndefOrNull(e,"")),c?this.loginInvalidMessage.removeClass("hidden"):this.loginInvalidMessage.addClass("hidden"),this.set("callback",f),this.firstTime?(this.render(),this.firstTime=!1):centerPanel(this),this.usernameField.focus()},handleLoginButton:function(a){this.handleButton(a)},handleButton:function(a){a.preventDefault(),this.hide();var b=this.connectionUrlField.get("value"),c=this.usernameField.get("value"),d=this.passwordField.get("value");this.connectionUrlField.set("value",""),this.usernameField.set("value",""),this.passwordField.set("value",""),this.get("callback")(b,c,d,!1)}},{ATTRS:{srcNode:{value:"#loginPanel"},centered:{value:!0},modal:{value:!0},zIndex:{value:5},buttons:{value:[]},callback:{value:null}}})},"0.99",{requires:["panel","gallery-widget-inherit-css"],skinnable:!1}),YUI.add("monitor-filter-panel",function(a){"use strict";var b=a.Lang,c="monitorFilterPanel",d="alpha",e="numeric",f="function";a.MonitorFilterPanel=a.Base.create(c,a.Panel,[a.WidgetInheritCss],{maxFilters:10,firstTime:!0,initializer:function(){this.plug(a.Plugin.Drag,{handles:[".yui3-widget-hd"]}),this.dd.plug(a.Plugin.DDConstrained,{constraint2node:"#content"}),this.set("dragObj",new a.DD.Drag({node:"#monitorFilterPanel"}))},buildFieldNameSelector:function(a,b,c){var d="monitorFilterFieldName_"+b,e=a.one("#"+d);e||(e=createSELECT(a,"monitorFilterFieldName").set("id","monitorFilterFieldName_"+b).set("tabIndex",1+3*b).setStyle("top",30*b),e.on("click",this.clickedFilter,this),e.on("change",this.selectedFilter,this)),removeAllChildren(e),this.addOption(e,"","Choose...");for(var f=this.get("fieldDefinitions"),g=0;g<f.length;g++){var h=f[g];this.addOption(e,h[0],h[1])}return e.set("selectedIndex",0),e.set("disabled",!c),e},buildAndDiv:function(a,b,c){var d="monitorFilterAnd_"+b,e=a.one("#"+d),f=a.create("<DIV>").addClass("monitorFilterAnd").set("text","and").set("id","monitorFilterAnd_"+b).setAttribute("disabled",!c).setStyle("top",30*b);return e?a.replaceChild(f,e):a.append(f),f},buildConditionSelector:function(a,b,c,f){var g="monitorFilterCondition_"+b,h=a.one("#"+g),i=a.create("<SELECT>").addClass("monitorFilterCondition").set("id","monitorFilterCondition_"+b).set("disabled",!f).set("tabIndex",2+3*b).setStyle("top",30*b);return c&&(this.addOption(i,"SET","is set"),this.addOption(i,"UNSET","is not set"),this.addOption(i,"EQ","=="),this.addOption(i,"NEQ","!=")),(c===d||c===e)&&(this.addOption(i,"LEQ","<="),this.addOption(i,"LT","<"),this.addOption(i,"GT",">"),this.addOption(i,"GEQ",">=")),c===d&&(this.addOption(i,"CONTAIN","contains"),this.addOption(i,"NOT_CONTAIN","does not contain"),this.addOption(i,"START","starts with"),this.addOption(i,"END","ends with")),h?a.replaceChild(i,h):a.append(i),i},buildTextValueEntry:function(a,b,c,d){var f="monitorFilterValue_"+b,g=a.one("#"+f),h=a.create("<INPUT>").addClass("monitorFilterValue").set("id",f).set("type",c===e?"number":"text").set("disabled",!d).set("tabIndex",3+3*b).setStyle("top",30*b);return g?a.replaceChild(h,g):a.append(h),h},buildSelectValueEntry:function(a,b,c,d){for(var e="monitorFilterValue_"+b,f=a.one("#"+e),g=a.create("<SELECT>").addClass("monitorFilterValue").set("id",e).set("selectedIndex",0).setStyle("top",30*b).set("disabled",!d).set("tabIndex",3+3*b).setStyle("top",30*b),h=0;h<c.length;h++)this.addOption(g,c[h],c[h]);return f?a.replaceChild(g,f):a.append(g),g},selectedFilter:function(a){var b=this,c=a.target,d=c.get("value"),e=c.get("id"),g=parseInt(e.substring(e.lastIndexOf("_")+1),10),h=c.get("parentNode");if(""!==d){var i=this.getFieldDefinition(d),j=i[2];if(this.buildConditionSelector(h,g,j,!0),typeOf(j)===f){var k=this.gatherFilterEntries();this.buildSelectValueEntry(h,g,j(k),!0)}else this.buildTextValueEntry(h,g,j,!0);g<this.maxFilters-1&&(h.one("#monitorFilterAnd_"+(g+1)).setAttribute("disabled",!1),h.one("#monitorFilterFieldName_"+(g+1)).set("disabled",!1))}else{this.buildConditionSelector(h,g,null,!1),this.buildTextValueEntry(h,g,null,!1);for(var l=g+1;l<this.maxFilters;l++)var m=this.buildAndDiv(h,l,!1),c=this.buildFieldNameSelector(h,l,!1,!1),n=this.buildConditionSelector(h,l,null,!1),o=this.buildTextValueEntry(h,l,null,!1)}},checkEnter:function(b){var c=b.keyCode?b.keyCode:b.which;if(13===c){b.preventDefault();var d=a.one("#sessionsSearchButton");d.simulate("click")}},display:function(a,b,c,d){this.set("clusterModel",a),this.set("fieldDefinitions",c),this.set("callback",d),this.firstTime?(this.render(),this.firstTime=!1):centerPanel(this),this.assignFilters(null),this.assignFilters(b),this.get("contentBox").one("#monitorFilterFieldName_0").focus()},assignFilters:function(a){var b=this.get("contentBox"),c=b.one("#monitorFilterListDiv"),d=0;if(void 0!==a&&null!==a){var e=a.getSubFilters();d=e.length;for(var f=null,g=null,h=0;d>h;h++){var i=e[h],j=this.getFieldDefinition(i.attribute),k=j[2];h>0&&(f=c.one("#monitorFilterAnd_"+h),f?f.setAttribute("disabled",!1):f=this.buildAndDiv(c,h,!0)),g=c.one("#monitorFilterFieldName_"+h),g?g.set("disabled",!1):g=this.buildFieldNameSelector(c,h,!0),this.setSelectItem(g,i.attribute);var l=this.buildConditionSelector(c,h,k,!0);this.setSelectItem(l,i.operator);var m=null;"function"===typeOf(k)?(m=this.buildSelectValueEntry(c,h,k(),!0),this.setSelectItem(m,i.value)):(m=this.buildTextValueEntry(c,h,k,!0),this.setTextItem(m,i.value))}}for(var n=d;n<this.maxFilters;n++)n>0&&this.buildAndDiv(c,n,n===d),this.buildFieldNameSelector(c,n,n===d),this.buildConditionSelector(c,n,null,!1),this.buildTextValueEntry(c,n,null,!1)},addOption:function(a,b,c){var d=createOPTION(a,null,c,b)},setSelectItem:function(a,b){for(var c=a.get("options"),d=0;d<c.size();d++){var e=c.item(d);e.get("value")===b&&a.set("selectedIndex",d)}},setTextItem:function(a,b){a.set("value",""+b)},gatherFilterEntries:function(){for(var b=[],c=0;c<this.maxFilters;c++){var d=a.one("#monitorFilterFieldName_"+c),e=d.get("value");if(e&&""!==e){var f=a.one("#monitorFilterCondition_"+c),g=f.get("value"),h=a.one("#monitorFilterValue_"+c),i=h.get("value").trim(),j=[e,g,i];b.push(j)}}return b},handleClearButton:function(a){a.preventDefault(),this.assignFilters(null)},handleOkayButton:function(a){a.preventDefault();for(var b=this.gatherFilterEntries(),c=[],d=new AndFilter,f=0;f<b.length;f++){var g=b[f],h=g[0],i=g[1],j=g[2],k=this.getFieldDefinition(h);if(""!==j||"SET"===i||"UNSET"===i){var l=k[2];if("function"===typeOf(l))d.addFilter(new ValueFilter(h,i,j));else if(l===e){if("SET"!==i&&"UNSET"!==i){if(!isNumeric(j)){c.push("Field '"+k[1]+"' must be a number");continue}j=parseFloat(j)}else j="";d.addFilter(new NumericFilter(h,i,j))}else d.addFilter(new AlphaFilter(h,i,j))}else c.push("Field '"+k[1]+"' has no value")}if(c.length>0){for(var m="Cannot save filter:",f=0;f<c.length;f++)m=m+"\n  "+c[f];return void alert(m)}this.hide();var n=this.get("callback");n&&n(d)},handleCancelButton:function(a){a.preventDefault(),this.hide()},getFieldDefinition:function(a){for(var b=this.get("fieldDefinitions"),c=null,d=0;d<b.length;d++)if(c=b[d],c[0]===a)return c;return null}},{ATTRS:{srcNode:{value:"#monitorFilterPanel"},clusterModel:{value:null},fieldDefinitions:{value:null},callback:{value:null},centered:{value:!0},modal:{value:!0},zIndex:{value:5},buttons:{value:[{value:"Clear",classNames:"monitorFilterClear commandButton",action:function(a){this.handleClearButton(a)},section:a.WidgetStdMod.FOOTER},{value:"OK",classNames:"monitorFilterOkay commandButton",action:function(a){this.handleOkayButton(a)},section:a.WidgetStdMod.FOOTER},{value:"Cancel",classNames:"monitorFilterCancel commandButton",action:function(a){this.handleCancelButton(a)},section:a.WidgetStdMod.FOOTER}]}}})},"0.99",{requires:["panel","dd","dd-plugin","dd-drag","event","gallery-widget-inherit-css"],skinnable:!1});