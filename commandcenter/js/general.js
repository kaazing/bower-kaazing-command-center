/**
 * Copyright (c) 2007-2014, Kaazing Corporation. All rights reserved.
*/
"use strict";function setupYUIPatches(){YUI.add("dt-refresh-row-patch",function(a){function b(){}b.prototype={initializer:function(){this.onceAfter("render",function(){this.body.refreshRow=function(a,b,c){var d,e,f=c.length,g;for(g=0;f>g;g++)d=c[g],e=a.one("."+this.getClassName("col",d)),e&&this.refreshCell(e,b);return this}})}},a.DataTable.RefreshRowPatch=b},"0.1",{requires:["datatable"]})}function start(a){document.getElementById("offscreenData").style.visibility="visible";var b="/commandcenter";setupYUIPatches(),YUI({filter:"min",base:b+"/yui/",combine:!1,useBrowserConsole:!0,debug:!1,lang:"en-US",groups:{gallery:{combine:!1,base:b+"/yui-gallery/",patterns:{"gallery-":{},"lang/gallery-":{},"gallerycss-":{type:"css"}}}},modules:{},onFailure:function(a){alert("There was an error. Failed to load the "+PRODUCT_NAME+" application:\n"+a.msg)}}).use("app","node","selector-css3","intl","transition","dt-refresh-row-patch","datatable","datatable-sort","datatable-scroll","panel","tabview","scrollview","stylesheet","gallery-widget-inherit-css","gallery-datatable-selection","dd","dd-drag","dd-plugin","gallery-contextmenu-view","event","event-custom","event-outside","router","widget","cluster-realm-config-view","cluster-service-config-view","command-center","config-gateways-view","config-overview-view","config-security-keystore-view","config-security-realms-view","config-security-truststore-view","config-service-defaults-view","config-services-view","cpu-all-perc-chart","cpu-avg-perc-chart","current-sessions-chart","dashboard-chart","dashboard-view","gateway-config-view","gateway-realm-config-view","gateway-service-config-view","jvm-heap-chart","kaazing-view","list-model","login-processor","monitor-gateways-view","monitor-services-view","monitor-sessions-view","nic-read-thpt-combined-chart","nic-read-thpt-indiv-chart","nic-rw-thpt-combined-chart","nic-write-thpt-combined-chart","nic-write-thpt-indiv-chart",function(b){continueStart(b,a)})}function continueStart(a,b){a.Base.mix(a.DataTable,[a.DataTable.RefreshRowPatch]),window.Y=a,a.Node.ATTRS.outerHeight={getter:function(){var a=this.get("offsetHeight");return a+parseFloat(this.getComputedStyle("marginTop"))+parseFloat(this.getComputedStyle("marginBottom"))}},a.Node.ATTRS.outerWidth={getter:function(){var a=this.get("offsetWidth");return a+parseFloat(this.getComputedStyle("marginLeft"))+parseFloat(this.getComputedStyle("marginRight"))}},new a.CommandCenter({challengeHandlerCreatorFn:b,viewContainer:"#viewContainer",transitions:!1,views:{dashboardView:{type:"DashboardView",preserve:!0},configOverviewView:{type:"ConfigOverviewView",preserve:!0},configServicesView:{type:"ConfigServicesView",preserve:!0},configServiceDefaultsView:{type:"ConfigServiceDefaultsView",preserve:!0},configSecurityRealmsView:{type:"ConfigSecurityRealmsView",preserve:!0},configSecurityKeystoreView:{type:"ConfigSecurityKeystoreView",preserve:!0},configSecurityTruststoreView:{type:"ConfigSecurityTruststoreView",preserve:!0},monitorGatewaysView:{type:"MonitorGatewaysView",preserve:!0},monitorServicesView:{type:"MonitorServicesView",preserve:!0},monitorSessionsView:{type:"MonitorSessionsView",preserve:!0}},serverRouting:!1})}function CommandCenterChallengeHandler(a,b){this.connectionUrl=b,this.loginPanel=a,this.username=null,this.password=null,this.challengeCallback=null,this.challengeCredentials=null,this.loginState=null,this.connected=!1}function Filter(){}function AndFilter(){this.subFilters=[]}function OrFilter(){this.subFilters=[]}function NumericFilter(a,b,c){this.attribute=a,this.operator=b,this.value=c}function AlphaFilter(a,b,c){this.attribute=a,this.operator=b,this.value=c}function ValueFilter(a,b,c){this.attribute=a,this.operator=b,this.value=c}function mopen(a){mcancelclosetime(),menuOpenSubmenu&&(menuOpenSubmenu.style.visibility="hidden"),menuOpenSubmenu=a,menuOpenSubmenu.style.visibility="visible"}function mclose(){menuOpenSubmenu&&(menuOpenSubmenu.style.visibility="hidden")}function mclosetime(){menuCloseTimer=window.setTimeout(function(){mclose()},menuTimeout)}function mcancelclosetime(){menuCloseTimer&&(window.clearTimeout(menuCloseTimer),menuCloseTimer=null)}function foo(){return!1}function MenuItem(a,b){this.parent=null,this.label=a,this.children=null,this.icon=null,this.clickFn=b?b:null,this.submenu=null,this.link=null}function defineMenu(a,b){var c=new MenuItem,d=c.addItem("dashboard",function(a){b.save("/dashboard")}),e=c.addItem("configuration");e.addItem("overview",function(a){b.save("/config/overview")}),e.addItem("services",function(a){b.save("/config/services")}),e.addItem("security - realms",function(a){b.save("/config/security/realms")}),e.addItem("security - keystores",function(a){b.save("/config/security/keystore")}),e.addItem("security - truststores",function(a){b.save("/config/security/truststore")}),e.addItem("service defaults",function(a){b.save("/config/service_defaults")});var f=c.addItem("monitoring");f.addItem("gateways",function(a){b.save("/monitor/gateways")}),f.addItem("services",function(a){b.save("/monitor/services")}),f.addItem("sessions",function(a){b.save("/monitor/sessions")});var g=c.addItem("about",function(a){b.handleAbout()});if(window.TEST_ENABLED){var h=c.addItem("test");h.addItem("Browser Information",function(a){var b=checkBrowserVersion();alert("browser.userAgent = ["+navigator.userAgent+"]\nbrowser.platform = ["+navigator.platform+"]\nbrowser.vendor = ["+navigator.vendor+"]\nbrowserInfo.OS = "+b.OS+"\nbrowser = "+b.browser+"\nbrowser version = "+b.version)})}return c}!function(){var a=1,b=2,c=3,d=4,e=CommandCenterChallengeHandler.prototype;e.defaultChallengeCredentials=null,e.canHandle=function(a){return null!=a&&"Basic"===a.authenticationScheme&&a.location.endsWith("/snmp")},e.handle=function(e,f){if(null===e.location)return void f(null);this.challengeCallback=f;var g=!1;if(null===this.loginState){if(this.challengeCredentials||this.defaultChallengeCredentials)return this.loginState=this.connected?b:a,void this.challengeCallback(this.makeChallengeResponse())}else{if(this.loginState===b)return void this.challengeCallback(this.makeChallengeResponse());if(this.loginState===a)this.challengeCredentials=null;else{if(this.loginState===d)return void this.challengeCallback(null);g=!0}}this.loginState=c,this.gatherCredentialsFn(g)},e.gatherCredentialsFn=function(a){var b=this;this.loginPanel.display(this.connectionUrl,!1,a,this.username,this.password,function(a,c,d,e){b.gatherCredentialsCallback(a,c,d,e)})},e.gatherCredentialsCallback=function(a,b,c,e){return e||null==b?(this.loginState=d,this.challengeCredentials=null,this.username=null,this.password=null,void this.challengeCallback(null)):(this.username=b,this.password=c,this.challengeCredentials=this.encodeCredentials(b,c),void this.challengeCallback(this.makeChallengeResponse()))},e.onOpen=function(a){CommandCenterChallengeHandler.prototype.defaultChallengeCredentials||(CommandCenterChallengeHandler.prototype.defaultChallengeCredentials=this.challengeCredentials),this.loginState=null,this.username=null,this.password=null,this.connected=!0},e.encodeCredentials=function(a,b){for(var c=a+":"+b,d=[],e=0;e<c.length;++e)d.push(c.charCodeAt(e));return Base64.encode(d)},e.makeChallengeResponse=function(){var a=this.challengeCredentials||this.defaultChallengeCredentials;return new Kaazing.Gateway.ChallengeResponse("Basic "+a,null)},e.onClose=function(a){this.connected=!1},e.isCancelled=function(){return 4===this.loginState}}(),function(){var a=Filter.prototype;a.findFilters=function(a){return null},a.match=function(a){return!0},a.toString=function(){return""}}(),function(){AndFilter.prototype=new Filter;var a=AndFilter.prototype;a.findFilters=function(a){for(var b=[],c=0;c<this.subFilters.length;c++){var d=this.subFilters[c];d.attribute===a&&b.push(d)}return b.length>0?b:null},a.addFilter=function(a){this.subFilters.push(a)},a.addFilters=function(a){a&&(this.subFilters=this.subFilters.concat(a))},a.deleteFilter=function(a){var b=this.subFilters,c=b.indexOf(a);c>=0&&b.splice(c,1)},a.insertFilter=function(a,b){var c=this.subFilters;c.splice(b,0,a)},a.getSubFilters=function(){return this.subFilters},a.match=function(a){for(var b=this.subFilters,c=0;c<b.length;c++){var d=b[c];if(!d.match(a))return!1}return!0},a.toString=function(){for(var a=this.subFilters,b="",c=0;c<a.length;c++){var d=a[c];c>0&&(b+=" and "),b=b+"("+d.toString()+")"}return b}}(),function(){OrFilter.prototype=new Filter;var a=OrFilter.prototype;a.findFilters=function(a){for(var b=[],c=0;c<this.subFilters.length;c++){var d=this.subFilters[c];d.attribute===a&&b.push(d)}return b.length>0?b:null},a.addFilter=function(a){this.subFilters.push(a)},a.addFilters=function(a){a&&(this.subFilters=this.subFilters.concat(a))},a.deleteFilter=function(a){var b=this.subFilters,c=b.indexOf(a);c>=0&&b.splice(c,1)},a.insertFilter=function(a,b){var c=this.subFilters;c.splice(b,0,a)},a.getSubFilters=function(){return this.subFilters},a.match=function(a){for(var b=this.subFilters,c=0;c<b.length;c++){var d=b[c];if(d.match(a))return!0}return!1},a.toString=function(){for(var a=this.subFilters,b="",c=0;c<a.length;c++){var d=a[c];c>0&&(b+=" or "),b=b+"("+d.toString()+")"}return b}}(),function(){NumericFilter.prototype=new Filter;var a=NumericFilter.prototype;a.match=function(a){var b=a.get(this.attribute);switch(this.operator){case"LT":return b<this.value;case"LEQ":return b<=this.value;case"EQ":return b===this.value;case"NEQ":return b!=this.value;case"GEQ":return b>=this.value;case"GT":return b>this.value;case"SET":return void 0!==b&&null!==b;case"UNSET":return void 0===b||null===b;default:return!1}},a.toString=function(){var a=this.attribute+" "+this.operToString();return"SET"!==this.operator&&"UNSET"!==this.operator&&(a=a+" "+this.value),a},a.operToString=function(){switch(this.operator){case"LT":return"<";case"LEQ":return"<=";case"EQ":return"==";case"NEQ":return"!=";case"GEQ":return">=";case"GT":return">";case"SET":return"is set";case"UNSET":return"is not set";default:return""}}}(),function(){AlphaFilter.prototype=new Filter;var a=AlphaFilter.prototype;a.match=function(a){var b=a.get(this.attribute);switch(b=b?b.toString():"",this.operator){case"LT":return b<this.value;case"LEQ":return b<=this.value;case"EQ":return b===this.value;case"NEQ":return b!=this.value;case"GEQ":return b>=this.value;case"GT":return b>this.value;case"CONTAIN":return b.indexOf(this.value,0)>=0;case"NOT_CONTAIN":return b.indexOf(this.value,0)<0;case"START":return b.startsWith(this.value);case"END":return b.endsWith(this.value);case"SET":return void 0!==b&&null!==b;case"UNSET":return void 0===b||null===b;default:return!1}},a.toString=function(){var a=this.attribute+" "+this.operToString();return"SET"!==this.operator&&"UNSET"!==this.operator&&(a=a+" '"+this.value+"'"),a},a.operToString=function(){switch(this.operator){case"LT":return"<";case"LEQ":return"<=";case"EQ":return"==";case"NEQ":return"!=";case"GEQ":return">=";case"GT":return">";case"CONTAIN":return"contains";case"NOT_CONTAIN":return"does not contain";case"START":return"starts with";case"END":return"ends with";case"SET":return"is set";case"UNSET":return"is not set";default:return""}}}(),function(){ValueFilter.prototype=new Filter;var a=ValueFilter.prototype;a.match=function(a){var b=a.get(this.attribute);switch(this.operator){case"EQ":return b===this.value;case"NEQ":return b!=this.value;case"SET":return void 0!==b&&null!==b;case"UNSET":return void 0===b||null===b;default:return!1}},a.toString=function(){var a=this.attribute+" "+this.operToString();return"SET"!==this.operator&&"UNSET"!==this.operator&&(a=a+" '"+this.value+"'"),a},a.operToString=function(){switch(this.operator){case"EQ":return"==";case"NEQ":return"!=";case"SET":return"is set";case"UNSET":return"is not set";default:return""}}}();var menuTimeout=500,menuCloseTimer=0,menuOpenSubmenu=0;!function(){var a=MenuItem.prototype;a.addItem=function(a,b){var c=new MenuItem(a,b);return c.parent=this,this.children?this.children.push(c):this.children=[c],c},a.isRoot=function(){return null===this.parent},a.isLeaf=function(){return null===this.children},a.renderMenu=function(a){this.renderItem(a,0)},a.renderItem=function(a,b){var c=this,d,e,f;if(!this.isRoot()){if(e=document.createElement("li"),a.appendChild(e),a=e,d=document.createElement("a"),a.appendChild(d),d.appendChild(document.createTextNode(this.label)),d.href="#",this.isLeaf())return void(c.clickFn&&(d.onclick=function(a){mclose(c.parent),c.clickFn(a),a.stopPropagation(),a.preventDefault()}));if(touchSupported()?d.onclick=function(a){mopen(c.submenu),a.stopPropagation(),a.preventDefault()}:(d.onmouseover=function(a){mopen(c.submenu)},d.onmouseout=function(a){mclosetime()}),c.isLeaf())return}this.submenu=document.createElement("ul"),a.appendChild(this.submenu),this.isRoot()?(this.submenu.id="mainmenu",this.label="Root menu"):(this.submenu.onmouseover=function(a){mcancelclosetime()},this.submenu.onmouseout=function(a){mclosetime()});for(var g=0;g<this.children.length;g++)this.children[g].renderItem(this.submenu,b+1)},document.onclick=function(){mclose()}}(),YUI.add("command-center",function(a){var b=a.Lang,c="commandCenter";a.CommandCenter=a.Base.create(c,a.App,[a.EventTarget],{resources:null,clusterModel:null,loginPanel:null,menu:null,chartMetadata:{},DEFAULT_CHART_LIST:["cpuAvgPercChart","currentSessionsChart","jvmHeapChart","nicRWThptCombinedChart"],monitorFilterPanel:null,aboutPanel:null,initializer:function(){var b=this,c=function(b){var c=a.one("window"),d=c.get("winHeight"),e=c.get("docHeight");d>e&&a.one("body").setStyle("height",d+"px")};c(),a.one("window").on("resize",c),window.onbeforeunload=function(a){b.handleBeforeUnload(a)},this.loginPanel=new a.LoginPanel,this.monitorFilterPanel=new a.MonitorFilterPanel,this.aboutPanel=new a.AboutPanel({app:b}),this.updatePanel=new a.UpdatePanel({app:b}),this.menu=defineMenu(a,b),this.menu.renderMenu(a.one("#mainMenuWrapper").getDOMNode()),this.setupRoutes();var d=this.get("challengeHandlerCreatorFn"),e=new a.LoginProcessor({loginPanel:this.loginPanel,app:this});this.clusterModel=new a.ClusterModel({loginProcessor:e}),this.clusterModel.addTarget(b),window.document.title=CC.PRODUCT_NAME,this.doBranding(),a.one("#headerLogo").on("click",function(a){b.handleVisitCompany()},this),a.one("#logoutLink").on("click",function(a){b.handleLogout()},this),this._setupCallback&&(this._setupCallback(),delete this._setupCallback),this.on("activeViewChange",this.activeViewChange,this),this.on("*:versionInfoChange",this.versionInfoChange,this),this.on(a.ClusterModel.prototype.UPDATE_AVAILABLE_EVENT,this.handleUpdateVersion,this);var f=window.location.hash;if(f&&"#"!==f){f.startsWith("#")&&(f=f.substring(1));var g=b.match(f);g.length>0?b.dispatch():b.save("/")}else this.save("/dashboard");this.setupStandardCharts();var h=window.location.host+"/snmp";h="https:"==window.location.protocol?"wss://"+h:"ws://"+h,this.clusterModel.start(h)},doBranding:function(){a.one("#headerLogoImage").setAttribute("src",CC.HEADER_LOGO_IMAGE_URL),a.one("#footerLogoImage").setAttribute("src",CC.FOOTER_LOGO_IMAGE_URL),a.one("#loginLogoImage").setAttribute("src",CC.LOGIN_LOGO_IMAGE_URL),a.one("#aboutLogoImage").setAttribute("src",CC.ABOUT_LOGO_IMAGE_URL),a.one("#updateLogoImage").setAttribute("src",CC.UPDATE_LOGO_IMAGE_URL),a.all(".copyrightNotice span").setHTML(CC.COPYRIGHT_NOTICE)},versionInfoChange:function(b){var c=a.one(".productTitle"),d=computeDisplayVersionInfo(b.newVal);d?c.set("text",d[0]+" "+d[1]):c.set("text","")},setupRoutes:function(){var a=this;a.route("/","handleDashboardView"),a.route("/dashboard","handleDashboardView"),a.route("/config/overview","handleConfigOverview"),a.route("/config/licenses","handleConfigLicenses"),a.route("/config/service_defaults","handleConfigServiceDefaults"),a.route("/config/services","handleConfigServices"),a.route("/config/security/realms","handleConfigSecurityRealms"),a.route("/config/security/keystore","handleConfigSecurityKeystore"),a.route("/config/security/truststore","handleConfigSecurityTruststore"),a.route("/monitor/gateways","handleMonitorGateways"),a.route("/monitor/services","handleMonitorServices"),a.route("/monitor/sessions","handleMonitorSessions")},handleDashboardView:function(a,b,c){this.startShowView("dashboardView",{model:this.clusterModel,toolbar:this.getToolBar(),app:this},null)},handleConfigOverview:function(a,b,c){this.startShowView("configOverviewView",{model:this.clusterModel,toolbar:this.getToolBar(),app:this},null)},handleConfigLicenses:function(a,b,c){this.startShowView("configLicensesView",{model:this.clusterModel,toolbar:this.getToolBar(),app:this},null)},handleConfigServiceDefaults:function(a,b,c){this.startShowView("configServiceDefaultsView",{model:this.clusterModel,toolbar:this.getToolBar(),app:this},null)},handleConfigServices:function(a,b,c){var d=a.query,e=d&&d.connectionUrl,f=d&&d.serviceId,g=null;if(!isEmpty(e)&&isNumeric(f)){f=parseInt(f);var h=this.findGatewayModelByConnectionUrl(e);h&&(g=h.get("gatewayConfig").getServiceConfig(f))}var i={model:this.clusterModel,toolbar:this.getToolBar(),app:this};null!==g&&(i.selectedServiceConfig=g),this.startShowView("configServicesView",i,{update:!0,render:!0})},handleConfigSecurityRealms:function(a,b,c){var d=a.query,e=d&&d.connectionUrl,f=d&&d.realm,g=null;if(!isEmpty(e)&&f&&f.length>0){var h=this.findGatewayModelByConnectionUrl(e);h&&(g=h.get("gatewayConfig").getRealmConfig(f))}var i={model:this.clusterModel,toolbar:this.getToolBar(),app:this};null!==g&&(i.selectedRealmConfig=g),this.startShowView("configSecurityRealmsView",i,{update:!0,render:!0})},handleConfigSecurityKeystore:function(a,b,c){this.startShowView("configSecurityKeystoreView",{model:this.clusterModel,toolbar:this.getToolBar(),app:this},null)},handleConfigSecurityTruststore:function(a,b,c){this.startShowView("configSecurityTruststoreView",{model:this.clusterModel,toolbar:this.getToolBar(),app:this},null)},handleMonitorGateways:function(a,b,c){this.startShowView("monitorGatewaysView",{model:this.clusterModel,toolbar:this.getToolBar(),filterPanel:this.monitorFilterPanel,app:this},null)},handleMonitorServices:function(a,b,c){this.startShowView("monitorServicesView",{model:this.clusterModel,toolbar:this.getToolBar(),filterPanel:this.monitorFilterPanel,app:this},null)},handleMonitorSessions:function(a,b,c){this.startShowView("monitorSessionsView",{model:this.clusterModel,toolbar:this.getToolBar(),filterPanel:this.monitorFilterPanel,app:this},null)},handleAbout:function(a,b,c){var d=this;invokeLater(function(){var a=d.aboutPanel;a.display()})},handleUpdateVersion:function(a,b,c){var d=this;invokeLater(function(){if(!d.get("manualCheckingForUpdate")){var a=d.updatePanel;a.display()}})},handleVisitCompany:function(){window.open(CC.COMPANY_WEBSITE_URL)},handleLogout:function(){confirm("Are you sure you want to log out of the "+CC.PRODUCT_NAME+"?")&&this.clusterModel&&(this.clusterModel.logout(),window.location=window.location.protocol+"//"+window.location.host+window.location.pathname)},handleBeforeUnload:function(a){this.clusterModel&&this.clusterModel.logout()},hasLoggedIn:function(){return this.clusterModel.get("loggedIn")},isCluster:function(){return this.clusterModel.get("isCluster")},activeViewChange:function(a){CC.console.debug("##### ACTIVE VIEW CHANGE!"),CC.console.debug("PREV VAL: "+(a.prevVal?a.prevVal.name:"null")),CC.console.debug("NEW VAL: "+(a.newVal?a.newVal.name:"null"))},isActiveView:function(a){return this.get("activeView")===a},findGatewayModelByConnectionUrl:function(a){var b=this.clusterModel.getSortedGateways();if(!b)return null;for(var c=0;c<b.length;c++){var d=b[c];if(d.get("connectionUrl")==a)return d}return null},startShowView:function(a,b,c){var d=this.get("activeView");d&&d.hideViewCallback&&d.hideViewCallback(),this.showView(a,b,c,this.showViewCallback)},showViewCallback:function(b){var c=b.get("title");a.one("#viewTitle").setHTML("<span>"+(c?c:"")+"</span>"),removeAllChildren("#viewToolBar"),a.one("#viewContainer").set("scrollTop",0),b.showViewCallback&&b.showViewCallback()},setViewTitle:function(b){var c=a.one("#viewTitle");c.setHTML(b)},getToolBar:function(){return a.one("#viewToolBar")},putChart:function(a,b,c){this.chartMetadata[a]=[b,c]},getChart:function(a){var b=this.chartMetadata[a];return b?b:null},getCharts:function(){return this.chartMetadata},setupStandardCharts:function(){this.putChart("currentSessionsChart","Current Sessions",a.CurrentSessionsChart),this.putChart("cpuAllPercChart","CPU % (all CPUs/cores)",a.CpuAllPercChart),this.putChart("cpuAvgPercChart","CPU % (average)",a.CpuAvgPercChart),this.putChart("jvmHeapChart","JVM Heap",a.JvmHeapChart),this.putChart("nicReadThptCombinedChart","Read Throughput Combined",a.NicReadThptCombinedChart),this.putChart("nicReadThptIndivChart","Read Throughput/Interface Card",a.NicReadThptIndivChart),this.putChart("nicRWThptCombinedChart","Total Read/Write Throughput",a.NicRWThptCombinedChart),this.putChart("nicWriteThptCombinedChart","Write Throughput Combined",a.NicWriteThptCombinedChart),this.putChart("nicWriteThptIndivChart","Write Throughput/Interface Card",a.NicWriteThptIndivChart)}},{ATTRS:{challengeHandlerCreatorFn:{value:null},root:{value:""},html5:{value:!1},manualCheckingForUpdate:{value:!1}}})},"0.99",{requires:["app","login-panel","monitor-filter-panel","about-panel","map-model","cluster-model","update-panel"],skinnable:!1}),YUI.add("login-processor",function(a){var b=a.Lang,c="loginProcessor";a.LoginProcessor=a.Base.create(c,a.Model,[],{initializer:function(){},requestLoginLock:function(a,b,c){var d=this,e=this.get("loginLock");if(e){if(e.gatewayModel!==a){for(var f=this.get("loginLockQueue"),g=0;g<f.length;g++)if(f[g].gatewayModel===a)return;f.push({gatewayModel:a,callback:b,canChangeUrl:c})}}else this.set("loginLock",{gatewayModel:a,callback:b,canChangeUrl:c}),invokeLater(function(){d.processLogin(!1,null,null)},0)},hasLoginLock:function(a){var b=this.get("loginLock");return null!==b&&b.gatewayModel===a},clearLoginLock:function(a){var b=this.get("loginLockQueue");if(this.hasLoginLock(a))if(0==b.length)this.set("loginLock",null);else{var c=b.shift();this.set("loginLock",c),invokeLater(function(){$this.processLogin(!1,null,null)},0)}else for(var d=0;d<b.length;d++)b[d].gatewayModel===a&&b.splice(index,1)},clearAllLoginLockRequests:function(){this.set("loginLockQueue",[]),this.set("loginLock",null)},processLogin:function(a,b,c){var d=this,e=this.get("loginLock"),f=e.gatewayModel.get("connectionUrl");this.get("loginPanel").display(f,e.canChangeUrl,a,b,c,function(a,b,c,e){d.gatherCredentialsCallback(a,b,c,e)})},gatherCredentialsCallback:function(a,b,c,d){var e=this,f=this.get("loginLock");return d||isEmpty(!b)||isEmpty(a)?void invokeLater(function(){e.clearLoginLock(f.gatewayModel)},0):void f.callback(a,b,c)}},{ATTRS:{app:{value:null},loginPanel:{value:null},loginLock:{value:null},loginLockQueue:{value:[]}}})},"0.99",{requires:["model","cluster-model","gateway-model"]});